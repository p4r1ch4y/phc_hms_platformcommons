generator client {
  provider = "prisma-client-js"
  output   = "../generated/tenant-client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Patient {
  id            String         @id @default(uuid())
  firstName     String
  lastName      String
  dateOfBirth   DateTime
  gender        Gender
  phone         String?
  address       String?
  abhaId        String?        @unique // Ayushman Bharat Health Account ID
  vitals        Vitals[]
  consultations Consultation[]
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model Vitals {
  id            String   @id @default(uuid())
  patientId     String
  patient       Patient  @relation(fields: [patientId], references: [id])
  temperature   Float?
  bloodPressure String?
  pulse         Int?
  weight        Float?
  height        Float?
  bloodSugar    Float?   // Random Blood Sugar in mg/dL
  recordedBy    String   // UserId of Nurse/ASHA
  recordedAt    DateTime @default(now())
}

model Consultation {
  id            String   @id @default(uuid())
  patientId     String
  patient       Patient  @relation(fields: [patientId], references: [id])
  doctorId      String   // User ID of the doctor
  diagnosis     String?
  prescription  String?
  status        ConsultationStatus @default(PENDING)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

enum Gender {
  MALE
  FEMALE
  OTHER
}

enum ConsultationStatus {
  PENDING
  COMPLETED
  CANCELLED
}

model Medicine {
  id                String   @id @default(uuid())
  name              String
  manufacturer      String?
  unit              String   // e.g., Tablet, Syrup, Injection
  lowStockThreshold Int      @default(10)
  batches           Batch[]
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model Batch {
  id          String   @id @default(uuid())
  medicineId  String
  medicine    Medicine @relation(fields: [medicineId], references: [id])
  batchNumber String
  expiryDate  DateTime
  quantity    Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
